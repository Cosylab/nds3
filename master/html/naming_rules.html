<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>NDS3: Naming rules</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">NDS3
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
   <div id="projectbrief">API reference manual</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('naming_rules.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Naming rules </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Each node or PV can have an external name set via <a class="el" href="group__naming.html#ga51043a20ed217e1cc5c7d767dd01fb3d" title="Set the string to pass to the naming rules in order to build the full node name as seen by the contro...">nds::Base::setExternalName()</a>. If the external name is not set then it has the same value as the node or PV's name.</p>
<p>The following code creates a Thermometer device with a single input PV named "Temperature"; note however that we add a line of code that changes the external name of the PV to "temp".<br/>
 </p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="nds_8h.html">nds3/nds.h</a>&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// This class declares our device in the contructor and supplies the functionalities to support it</span></div>
<div class="line"><span class="comment"></span><span class="keyword">class </span>Thermometer</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line"></div>
<div class="line"><span class="comment">// Constructor. Here we setup the device structure</span></div>
<div class="line"><span class="comment"></span>Thermometer(<a class="code" href="classnds_1_1_factory.html">nds::Factory</a> &amp;factory,</div>
<div class="line">            <span class="keyword">const</span> std::string &amp;deviceName,</div>
<div class="line">            <span class="keyword">const</span> <a class="code" href="namespacends.html#a1623ccf32bf1883cc75d22e2471c535b">nds::namedParameters_t</a> &amp;parameters)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="classnds_1_1_port.html">nds::Port</a> rootNode(deviceName);</div>
<div class="line">   </div>
<div class="line">    <a class="code" href="classnds_1_1_p_v_base_in.html">nds::PVBaseIn</a> ourOnlyPV = rootNode.addChild(<a class="code" href="classnds_1_1_p_v_delegate_in.html">nds::PVDelegateIn&lt;double&gt;</a>(<span class="stringliteral">&quot;Temperature&quot;</span>, std::bind(&amp;Thermometer::getTemperature, </div>
<div class="line">                                                                         <span class="keyword">this</span>, </div>
<div class="line">                                                                         std::placeholders::_1, </div>
<div class="line">                                                                         std::placeholders::_2));</div>
<div class="line"></div>
<div class="line">    <span class="comment">// The following line causes our temperature PV to be exposed as &quot;temp&quot;</span></div>
<div class="line"><span class="comment"></span>    ourOnlyPV.<a class="code" href="group__naming.html#ga51043a20ed217e1cc5c7d767dd01fb3d">setExternalName</a>(<span class="stringliteral">&quot;temp&quot;</span>);</div>
<div class="line"></div>
<div class="line">    rootNode.initialize(<span class="keyword">this</span>, factory);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> getTemperature(timespec* pTimestamp, <span class="keywordtype">double</span>* pValue)</div>
<div class="line">{</div>
<div class="line">     pValue = 10; <span class="comment">// It is always cold in here</span></div>
<div class="line">}</div>
<div class="line"></div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="comment">// If we want to load our device support dynamically then we have to compile it</span></div>
<div class="line"><span class="comment">//  as a dynamic module and we have to provide the functions to allocate it,</span></div>
<div class="line"><span class="comment">//  deallocate it and retrieve its name</span></div>
<div class="line"><span class="comment"></span><a class="code" href="definitions_8h.html#abae220b9d7ab927324ef6caa20107576">NDS_DEFINE_DRIVER</a>(Thermometer, Thermometer);</div>
</div><!-- fragment --><p>For instance, if we create the device on an EPICS IOC we will see the following: </p>
<pre class="fragment">epics&gt; createNdsDevice Thermometer myThermometer
epics&gt; iocInit
epics&gt; dbl
myThermometer-temp
</pre><p>The external names can be modified even further by loading and applying a <a class="el" href="naming_rules.html#naming_rules_file">Naming rules definition file</a>.</p>
<p>The naming rules definition file contains the transformations to apply to each node according to its type and also defines the separator to insert between the component names.</p>
<h1><a class="anchor" id="naming_rules_file"></a>
Naming rules definition file</h1>
<p>The naming rules definition file is an INI file that can contain one or more sections, which in turn can have several lines defining the naming rules (one rule per line).</p>
<p>Each section name is enclosed by square brackets while each rule is a variable assignment where the variable name is the rule name and the value is a printf format string that defines how the name must be built.</p>
<p>Comments begin with the char #.</p>
<p>Example: </p>
<pre class="fragment">[COSYLAB]   # Naming rules for COSYLAB

toUpper = 1 # All the names will be converted to upper-case

# The separator for the level 0 is empty (nothing is prepended to the root node name)
separator0 =

separator1 = /   # Example root/node0
separator2 = -   # Example root/node0-node1

# We don't have a separator for the level 3 and subsequent, so the separator2 will be used
# for deeper levels

# How do we form the root node name
rootNode = "DEVICE_%s_COSYLAB"

# Input PV
inputPV = "GET_%s"

# Output PV
outputPV = "SET %s"
</pre><p>If we apply those rules to the sample code from <a class="el" href="naming_rules.html">Naming rules</a> then the temperature PV will be available with the following name: </p>
<div class="fragment"><div class="line">epics&gt; dbl</div>
<div class="line">DEVICE_MYTHERMOMETER_COSYLAB/GET_TEMP</div>
</div><!-- fragment --><h2><a class="anchor" id="naming_rules_variables"></a>
Recognized variables in the Rules Definition File</h2>
<h3><a class="anchor" id="toUpper"></a>
toUpper</h3>
<p>If the value is 1 then all the external names are converted to upper-case before being fed into the naming rules. The default value is 0.</p>
<h3><a class="anchor" id="toLower"></a>
toLower</h3>
<p>If the value is 1 then all the external names are converted to lower-case before being fed into the naming rules. The default value is 0. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Thu Mar 29 2018 21:54:50 for NDS3 by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
